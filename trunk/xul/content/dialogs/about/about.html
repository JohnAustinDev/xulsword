<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!--
    This file is part of xulSword.

    Copyright 2009 John Austin (gpl.programs.info@gmail.com)

    xulSword is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 2 of the License, or
    (at your option) any later version.

    xulSword is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with xulSword.  If not, see <http://www.gnu.org/licenses/>.
!-->
<html>
  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="PSPad editor, www.pspad.com">
  <title>About</title>
  <link rel="stylesheet" href="chrome://xulsword/skin/common/global-htm.css" type="text/css">
  <link rel="stylesheet" href="chrome://xulsword/skin/dialogs/about/about-htm.css" type="text/css">
  
  <script>var MainWindow = window.frameElement.ownerDocument.defaultView.MainWindow;</script>
  <script type="text/javascript" src="chrome://xulsword/content/common/common0.js"></script>
  <script type="text/javascript" src="chrome://xulsword/content/common/common1.js"></script>
  
  <script>
  
  function onLoad() {
    initCSS();
   
    if (!CommandTarget.mod) return;
    
    // show the CommandTarget module info...
    window.frameElement.ownerDocument.getElementById("mainbox").setAttribute("showingModules", "true");
    window.setTimeout("document.getElementById('mod." + CommandTarget.mod + "').scrollIntoView(true);", 1);
    
  }
  
  function toggleInfo(mod) {
    var elem = document.getElementById("conf." + mod);
    var showInfo = elem.getAttribute("showInfo");
   
   setEditable(mod, false);
   
    if (showInfo == "false") {
      elem.getElementsByClassName("confpath")[0].innerHTML = Tab[mod].conf.path;
      var confInfo = "-----";
      if (Tab[mod].conf) {
        confInfo  = readFile(Tab[mod].conf);
      }
      elem.getElementsByTagName("textarea")[0].value = confInfo;
    }

    elem.setAttribute("showInfo", (showInfo == "true" ? "false":"true"));

  }
  
  function setEditable(mod, editable) {
    if (editable) {
      document.getElementById('conftext.' + mod).removeAttribute('readonly');
      document.getElementById('conf.' + mod).removeAttribute('readonly');
    }
    else {
      document.getElementById('conftext.' + mod).setAttribute('readonly', 'readonly');
      document.getElementById('conf.' + mod).setAttribute('readonly', 'readonly');
    }
  }
  
  function saveConfText(mod) {
    var elem = document.getElementById("conf." + mod);
    var conftext = elem.getElementsByTagName("textarea")[0].value;
    writeFile(Tab[mod].conf, conftext, true);
    setEditable(mod, false);
  }
  
  function getUI(id) {
    return window.frameElement.ownerDocument.defaultView.getDataUI(id);
  }
    
  </script>
  
  </head>
  
  <body id="scrollbox" onload="onLoad();">
    <script>
    
      document.write("<a href=\"#top\"></a>");
      
      // begin with a basic module listing
      var lastType;
      for (var t=0; t<Tabs.length; t++) {
      
        if (!lastType || Tabs[t].modType != lastType) {
          var type = getUI("search." + Tabs[t].tabType);
          document.write("<div class=\"mod-heading\">" + type + "</div>");
        }
        lastType = Tabs[t].modType;
        
        document.write("<a class=\"link cs-" + Tabs[t].locName + "\" href=\"#" + Tabs[t].modName + "\">");
        document.write(Tabs[t].label + " - " + Tabs[t].description);
        document.write("</a>");
        
      }
      
      document.write("<div id=\"separator\"></div>");
      
      // now show detailed module listing
      for (t=0; t<Tabs.length; t++) {
        
        // Module's target link
        document.write("<a class=\"mod-anchor\" id=\"mod." + Tabs[t].modName + "\" name=\"" + Tabs[t].modName + "\"></a>");
        
        document.write("<div class=\"module-detail cs-" + Tabs[t].locName + "\">");
        
        // Heading and version
        var vers = LibSword.getModuleInformation(Tabs[t].modName, "Version");
        document.write(  "<span class=\"mod-detail-heading\">");
        document.write(    Tabs[t].label + (vers != NOTFOUND ? "(" + vers + ")":""));
        document.write(  "</span>");
        document.write(  "<a href=\"#top\" class=\"return-link\"></a>");
        
        // Descripton
        if (Tabs[t].description) 
            document.write("<div class=\"description\">" + Tabs[t].description + "</div>");
 
        // Copyright
        var copyright = LibSword.getModuleInformation(Tabs[t].modName, "DistributionLicense");
        if (copyright == NOTFOUND) copyright = "";
        if (copyright)
             document.write("<div class=\"copyright\">" + copyright + "</div>");
             
        // About
        var about = LibSword.getModuleInformation(Tabs[t].modName,"About");
        if (about == Tabs[t].description || about == NOTFOUND) about = "";
        if (about) {
          about = about.replace(/(\\par)/g, "<br>");
          document.write("<div class=\"about\">" + about + "</div>");
        }
             
        document.write("</div>"); // end module-detail
             
        // Conf contents
        document.write("<div id=\"conf." + Tabs[t].modName + "\" class=\"conf-info\" showInfo=\"false\" readonly=\"readonly\">");
        document.write(  "<a class=\"link\" href=\"javascript:toggleInfo('" + Tabs[t].modName + "');\">");
        document.write(    "<span class=\"more-label\">" + getUI("more.label") + "</span>");
        document.write(    "<span class=\"less-label\">" + getUI("less.label") + "</span>");
        document.write(  "</a>");
        document.write(  "<a class=\"link edit-link\" href=\"javascript:setEditable('" + Tabs[t].modName + "', true);\">");
        document.write(    "<span class=\"less-label\">" + safeGetStringFromName("edit", null, "common/additional.properties", "edit.label") + "</span>");
        document.write(  "</a>");
        document.write(  "<a class=\"link save-link\" href=\"javascript:saveConfText('" + Tabs[t].modName + "');\">");
        document.write(    "<span class=\"less-label\">" + safeGetStringFromName("save", null, "common/additional.properties", "save.label") + "</span>");
        document.write(  "</a>");
        document.write(  "<div class=\"confpath\"></div>");
        document.write(  "<textarea id=\"conftext." + Tabs[t].modName + "\" class=\"cs-" + DEFAULTLOCALE + "\" readonly=\"readonly\"></textarea>");
        document.write("</div>");

      }
      
    </script>
    
  </body>
</html>
